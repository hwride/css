<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Response images with srcset and sizes</title>
	<link rel="stylesheet" type="text/css" href="../common.css">
	<style>
		body {
			max-width: none;
			margin: 16px;
		}

		h2 {
			margin-top: 0;
		}
		.example {
			padding-block: 8px;
		}
		.example:not(:last-of-type) {
			border-bottom: 1px solid black;
		}

		.info {
			position: fixed;
			top: 8px;
			right: 8px;
			background: rgba(30, 144, 255, 0.8);
			padding: 8px;
			border-radius: 8px;
		}
		.info table,
		.info table td {
			border: none;
		}
		.info tr td:first-child {
			padding-right: 8px;
		}
	</style>
</head>
<body>
<h1>Response images with srcset and sizes</h1>
<div class="info">
	<table>
		<tr>
			<td><code>window.devicePixelRatio</code></td><td><span class="device-pixel-ratio"></span></td>
		</tr>
		<tr>
			<td><code>window.outerWidth</code></td><td><span class="window-outer-width"></span></td>
		</tr>
		<tr>
			<td><code>devicePixelRatio * outerWidth</code></td><td><span class="device-pixels-outer"></span></td>
		</tr>
		<tr>
			<td><code>window.innerWidth</code></td><td><span class="window-inner-width"></span></td>
		</tr>
		<tr>
			<td><code>devicePixelRatio * innerWidth</code></td><td><span class="device-pixels-inner"></span></td>
		</tr>
	</table>
</div>

<div class="example">
	<ul>
		<li>How does rounding work for device pixel ratio and width descriptors?</li>
		<li>Why are the images below different rendered widths when the same image is picked?</li>
	</ul>
</div>

<div class="example">
	<h2>
		Simple image with <code>src</code> attribute
	</h2>
	<pre>
&lt;img alt="A test responsive image"
     src="fallback.png" /&gt;
		</pre>
	<img alt="A test responsive image"
			 src="fallback.png" />
</div>

<!-- Device pixel ratio -->
<div class="example">
	<h2>
		Image with <code>srcset</code> and display density descriptor.
	</h2>
	<p class="example-description">
		The pixel density descriptor of <code>srcset</code> lets you tell the browser what image should be used
		depending on the device pixel ratio. If there are 1x, 2x or 3x device pixels to CSS pixels then the corresponding
		image will be chosen.
	</p>
	<p class="example-description">
		You can see the device pixel ratio in the information in the bottom right of the screen under <code>devicePixelRatio</code>.
	</p>
	<p class="example-description">
		Note that the actual number width of the device or window does not affect the calculation, only the device pixel
		ratio.
	</p>
	<pre>
&lt;img alt="A test responsive image"
     src="fallback.png"
     srcset="500x250.png 1x,
             1000x250.png 2x,
             1500x250.png 3x" /&gt;
		</pre>
	<img
		alt="A test responsive image"
		src="fallback.png"
		srcset="
			500x250.png 1x,
			1000x250.png 2x,
			1500x250.png 3x
		" />
</div>

<!-- srcset with pixel widths-->
<div class="example">
	<h2>
		Image with <code>srcset</code> and pixel widths.
	</h2>
	<p class="example-description">
		Here <code>srcset</code> is used to define at images at different sizes. The format is:
		<code>&lt;image-url&gt; &lt;width descriptor&gt;</code>. Width descriptor describes the pixel width of the source
		image in pixels (even though it ends in a <code>w</code>).
	</p>
	<p class="example-description">
		When <code>srcset</code> is used without <code>sizes</code>, it is assumed the image should fill the entire browser
		width.
	</p>
	<p class="example-description">
		Note that even when using width descriptors with <code>srcset</code>, the browser will try and take pixel density
		into account. It will do this by selecting an image size according to device pixels rather than CSS pixels. You
		can see this value in the info section as <code>devicePixelRatio * outerWidth</code>.
	</p>
	<pre>
&lt;img alt="A test responsive image"
     src="fallback.png"
     srcset="250x250.png 250w,
             500x250.png 500w,
             1000x250.png 1000w,
             1500x250.png 1500w" /&gt;
		</pre>
	<!-- src is a fallback for older browsers -->
	<!-- srcset: browser uses first condition that matches -->
	<!-- sizes: it appears the media queries match the document width and not the window width, at least on Chrome -->
	<img alt="A test responsive image"
			 src="fallback.png"
			 srcset="250x250.png 250w,
								 500x250.png 500w,
								 1000x250.png 1000w,
								 1500x250.png 1500w" />
</div>

<!-- srcset and sizes-->
<div class="example">
	<h2>
		Image with <code>srcset</code> and <code>sizes</code> attribute
	</h2>
	<p class="example-description">
		When using the <code>sizes</code> attributes you are able to specify conditions about when each image should be
		used yourself.
	</p>
	<p class="example-description">
		An important thing to note is the <code>sizes</code> media conditions use CSS pixels, but the actual image size
		chosen from <code>srcset</code> will continue to take pixel density into account.
	</p>
	<p class="example-description">
		The statements in <code>sizes</code> are read first to last, and the first matching one will one. This means order
		is important depending on how you write your media conditions.
	</p>
	<pre>
&lt;img alt="A test responsive image"
     src="fallback.png"
     srcset="250x250.png 250w,
             500x250.png 500w,
             1000x250.png 1000w,
             1500x250.png 1500w"
     sizes="(min-width: 1500px) 1500px,
            (min-width: 1000px) 1000px,
            (min-width: 500px) 500px,
            (min-width: 250px) 250px,
            100vw" /&gt;
		</pre>
	<!-- src is a fallback for older browsers -->
	<!-- srcset: browser uses first condition that matches -->
	<!-- sizes: it appears the media queries match the document width and not the window width, at least on Chrome -->
	<img alt="A test responsive image"
			 src="fallback.png"
			 srcset="250x250.png 250w,
								 500x250.png 500w,
								 1000x250.png 1000w,
								 1500x250.png 1500w"
			 sizes="(min-width: 1500px) 1500px,
								(min-width: 1000px) 1000px,
								(min-width: 500px) 500px,
								(min-width: 250px) 250px,
								100vw" />
</div>


<div class="example">
	<h2>
		Results
	</h2>
	<table>
		<thead>
			<tr>
				<th>Device</th>
				<th>Device pixel ratio</th>
				<th>outerWidth</th>
				<th>innerWidth</th>
				<th>Device pixels - inner</th>
				<th>DPR image</th>
				<th>srcset only image</th>
				<th>srcset + sizes image</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>iPhone 11</td>
				<td>2</td>
				<td>414</td>
				<td></td>
				<td></td>
				<td>1000x250</td>
				<td>1000x250</td>
				<td>500x250</td>
			</tr>
			<tr>
				<td>mono e(7i) power</td>
				<td>1.75</td>
				<td>412</td>
				<td></td>
				<td></td>
				<td>1000x250</td>
				<td>1000x250</td>
				<td>1000x250</td>
			</tr>
			<tr>
				<th colspan="6">Windows 10 + Chrome 105</th>
			</tr>
			<tr>
				<td>Windows 10 + Chrome 105</td>
				<td>1</td>
				<td>516</td>
				<td></td>
				<td></td>
				<td>500x250</td>
				<td>500x250</td>
				<td>500x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Chrome 105</td>
				<td>1</td>
				<td>520</td>
				<td></td>
				<td></td>
				<td>1000x250</td>
				<td>1000x250</td>
				<td>1000x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Chrome 105</td>
				<td>1</td>
				<td>1000</td>
				<td></td>
				<td></td>
				<td>1000x250</td>
				<td>1000x250</td>
				<td>1000x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Chrome 105</td>
				<td>1</td>
				<td>1017</td>
				<td></td>
				<td></td>
				<td>1500x250</td>
				<td>1500x250</td>
				<td>1500x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Chrome 105</td>
				<td>1.25</td>
				<td>2048</td>
				<td></td>
				<td></td>
				<td>1500x250</td>
				<td>1500x250</td>
				<td>1500x250</td>
			</tr>

			<!-- Firefox -->
			<tr>
				<th colspan="6">Windows 10 + Firefox 104</th>
			</tr>
			<tr>
				<td>Windows 10 + Firefox 104</td>
				<td>1.2</td>
				<td>426</td>
				<td>416</td>
				<td>499.2</td>
				<td>1000x250</td>
				<td>500x250</td>
				<td>500x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Firefox 104</td>
				<td>1.2</td>
				<td>427</td>
				<td>417</td>
				<td>500.4</td>
				<td>1000x250</td>
				<td>1000x250</td>
				<td>500x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Firefox 104</td>
				<td>1.2</td>
				<td>509</td>
				<td>499</td>
				<td>611</td>
				<td>1000x250</td>
				<td>1000x250</td>
				<td>500x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Firefox 104</td>
				<td>1.2</td>
				<td>510</td>
				<td>500</td>
				<td>612</td>
				<td>1000x250</td>
				<td>1000x250</td>
				<td>1000x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Firefox 104</td>
				<td>1.2</td>
				<td>842</td>
				<td>833</td>
				<td>999.59</td>
				<td>1000x250</td>
				<td>1000x250</td>
				<td>1000x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Firefox 104</td>
				<td>1.2</td>
				<td>844</td>
				<td>834</td>
				<td>1000.8</td>
				<td>1000x250</td>
				<td>1500x250</td>
				<td>1000x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Firefox 104</td>
				<td>1.2</td>
				<td>1009</td>
				<td>999</td>
				<td>1199</td>
				<td>1000x250</td>
				<td>1500x250</td>
				<td>1000x250</td>
			</tr>
			<tr>
				<td>Windows 10 + Firefox 104</td>
				<td>1.2</td>
				<td>1010</td>
				<td>1000</td>
				<td>1212</td>
				<td>1000x250</td>
				<td>1500x250</td>
				<td>1500x250</td>
			</tr>
		</tbody>
	</table>
</div>
</body>
<script src="../nav.js"></script>
<script>createNav()</script>
<script src="srcset-sizes.js"></script>
</html>
